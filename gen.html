<canvas id="maze" width="900" height="300"></canvas>
<script>
function mulberry32(a) {
  return function() {
    var t = a += 0x6D2B79F5;
    t = Math.imul(t ^ (t >>> 15), t | 1);
    t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
    return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
  };
}

function generateMaze(width, height, startX, startY, rnd) {
  const maze = Array.from({ length: height }, () => Array(width).fill(1));
  const stack = [];
  const dirs = [[2,0],[-2,0],[0,2],[0,-2]];

  function carve(x, y) {
    maze[y][x] = 0;
    stack.push([x, y]);
    while (stack.length) {
      const [cx, cy] = stack[stack.length - 1];
      const neighbors = dirs
        .map(([dx, dy]) => [cx + dx, cy + dy])
        .filter(([nx, ny]) => nx > 0 && ny > 0 && nx < width-1 && ny < height-1 && maze[ny][nx] === 1);
      if (neighbors.length) {
        const [nx, ny] = neighbors[Math.floor(rnd() * neighbors.length)];
        maze[(cy + ny)/2][(cx + nx)/2] = 0;
        maze[ny][nx] = 0;
        stack.push([nx, ny]);
      } else {
        stack.pop();
      }
    }
  }

  carve(startX, startY);
  return maze;
}

function drawMaze(ctx, maze, offsetX, cellSize) {
  for (let y = 0; y < maze.length; y++) {
    for (let x = 0; x < maze[0].length; x++) {
      if (maze[y][x]) {
        ctx.fillRect(offsetX + x * cellSize, y * cellSize, cellSize, cellSize);
      }
    }
  }
}

const canvas = document.getElementById('maze');
const ctx = canvas.getContext('2d');
const cols = 43, rows = 43, cellSize = 6;
const seed = Math.floor(Math.random() * 99999);
const rnd1 = mulberry32(seed);
const rnd2 = mulberry32(seed);
const rnd3 = mulberry32(seed);

const startCol = (Math.floor(Math.random()*((cols-2)/2))*2+1);
const startRow = (Math.floor(Math.random()*((rows-2)/2))*2+1); 
const mazes = [
  generateMaze(cols, rows, 1, 1, rnd1), // 左上
  generateMaze(cols, rows, Math.floor(cols/2)|1, Math.floor(rows/2)|1, rnd2), // 中央
  generateMaze(cols, rows, startCol, startRow, rnd3), // ランダム
];

ctx.fillStyle = "black";
ctx.fillRect(0, 0, canvas.width, canvas.height);
ctx.fillStyle = "white";

mazes.forEach((m, i) => drawMaze(ctx, m, i * (cols+1) * cellSize, cellSize));

ctx.fillStyle = "red";
ctx.font = "16px monospace";
ctx.fillText("Left-Top", 10, rows*cellSize + 20);
ctx.fillText("Center", (cols+1)*cellSize + 10, rows*cellSize + 20);
ctx.fillText(`Random (${startCol}, ${startRow})`, (cols+1)*cellSize*2 + 10, rows*cellSize + 20);

console.log("Seed:", seed);
</script>
